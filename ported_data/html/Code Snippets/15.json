{"date_published": "2011-05-27", "author": "virtualastronomer", "description": "<div class=\"entry\" id=\"blogbody\">\n<p>Here is a quick snippet of code using VOEventLib to ingest data from an event stream. it also uses the very nice <a href=\"http://www.feedparser.org/\" target=\"_blank\">feedparser</a> python module for RSS and Atom feeds.</p><pre class=\"python\" name=\"code\"># pip install feedparser\n# pip install http://lib.skyalert.org/VOEventLib/VOEventLib-0.3.tar.gz\n\nimport urllib2\nimport feedparser\u00a0 \nfrom VOEventLib import Vutil as VOEventTools\n\n# the AAVSO Atom Stream from http://www.skyalert.org/feeds/\naavso = \"http://www.skyalert.org/feeds/324/\"\n# same for CBAT\ncbat = \"http://www.skyalert.org/feeds/290\"\n\n# pick cbat\nstream = aavso\n\n# open the stream\nevents = feedparser.parse(stream)\nlatest = events.entries[0]\n\n# get the first \"XML\" link for that event\nxmlref = [link['href'] for link in latest.links if link['rel'] == u'xml'][0]\n\n# get event XML as string, write to file\nwith open('event.xml','wb') as outfile:\n\u00a0\u00a0\u00a0 handler = urllib2.urlopen(xmlref)\n\u00a0\u00a0\u00a0 rawdata = handler.read()\n\u00a0\u00a0\u00a0 outfile.write(rawdata)\n\u00a0\u00a0\u00a0 handler.close()\n\n# you can parse either the raw string\nevent = VOEventTools.parseString(rawdata)\n# or the file you just wrote\nevent = VOEventTools.parse('event.xml') \n\n# get some event information\nauthor = event.Who.Author.get_contactName()[0]\n\n# this helper function extracts some of the observation's data (sans metadata) \nww = VOEventTools.getWhereWhen(event)\ns = ww['coord_system']\n\nassert 'ICRS' in s or 'FK5' in s\nra = ww['longitude']\ndec = ww['latitude']\n\n# someone will note that the RSS packet contains part\n# of this data (sans detailed metadata) without accessing the\n# XML packet. Fine, here is that code:\n\nauthor_ = latest['author']\nra_ = float(latest[u'voevent_ra'])\ndec_ = float(latest[u'voevent_dec'])\n\n</pre><p></p>\n</div>", "tags": ["vo", "time"], "title": "VOEvent parsing snippet"}